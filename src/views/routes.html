<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Available Routes</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#6ee7b7;--accent2:#60a5fa}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071124 0%,#081224 100%);color:#e6eef6}
    .wrap{max-width:1100px;margin:28px auto;padding:24px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:20px;margin:0}
    p.base{margin:0;color:var(--muted)}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.02));border:1px solid rgba(255,255,255,0.03);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6)}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    thead th{background:rgba(255,255,255,0.02);text-align:left;padding:12px;font-size:13px;color:var(--muted)}
    tbody tr{border-top:1px solid rgba(255,255,255,0.02)}
    td{padding:12px;font-size:14px;vertical-align:middle}
    .method{width:88px;font-weight:600;text-transform:uppercase;border-radius:6px;padding:6px 8px;color:#063a3a;background:linear-gradient(90deg,var(--accent),#34d399)}
    .path a{color:var(--accent2);text-decoration:none;font-weight:600}
    .desc{color:var(--muted);font-size:13px}
    .curl{font-family:monospace;background:#071428;padding:8px;border-radius:6px;color:#9fb3d0;display:inline-block}
    .copy{margin-left:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);padding:6px 8px;border-radius:6px;color:var(--muted);cursor:pointer}
    footer{margin-top:14px;color:var(--muted);font-size:13px}
    @media (max-width:720px){.method{display:inline-block;width:auto}.wrap{padding:12px}td{padding:8px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Available Routes</h1>
        <p class="base">Base URL: <code id="base">loading...</code></p>
      </div>
    </header>

    <div class="card">
      <table>
        <thead>
          <tr>
            <th>Method</th>
            <th>Path</th>
            <th>Description</th>
            <th>Example</th>
          </tr>
        </thead>
        <tbody id="routes-body">
          <tr><td colspan="4" style="padding:20px;color:var(--muted)">Loading routes...</td></tr>
        </tbody>
      </table>
      <footer>Click GET links to open in your browser. Use the copy button to copy curl commands for POST endpoints.</footer>
    </div>
  </div>

  <script>
    async function load() {
      try {
        const res = await fetch('/routes.json');
        const data = await res.json();
        const base = data.base || (location.protocol + '//' + location.host);
        document.getElementById('base').textContent = base;
        const tbody = document.getElementById('routes-body');
        tbody.innerHTML = '';
        (data.routes || []).forEach(r => {
          const full = base + r.path;
          const tr = document.createElement('tr');

          const tdMethod = document.createElement('td');
          tdMethod.innerHTML = `<span class="method">${r.method}</span>`;

          const tdPath = document.createElement('td');
          if (r.method === 'GET') {
            tdPath.innerHTML = `<div class="path"><a href="${full}">${r.path}</a></div>`;
          } else {
            tdPath.innerHTML = `<div class="path"><code>${r.path}</code></div>`;
          }

          const tdDesc = document.createElement('td');
          tdDesc.innerHTML = `<div class="desc">${r.description || ''}</div>`;

          const tdExample = document.createElement('td');
          let curl = `curl -X ${r.method} ${full}`;
          if (r.method === 'POST') curl += ` \n  -H "Content-Type: application/x-www-form-urlencoded" \n  -d "..."`;
          tdExample.innerHTML = `<div class="curl">${curl.replace(/</g,'&lt;')}</div>`;

          if (r.method === 'POST') {
            const btn = document.createElement('button');
            btn.className = 'copy';
            btn.textContent = 'Copy';
            btn.addEventListener('click', () => {
              navigator.clipboard && navigator.clipboard.writeText(curl).then(()=>{
                btn.textContent = 'Copied';
                setTimeout(()=>btn.textContent='Copy',1200);
              });
            });
            tdExample.appendChild(btn);
          }

          tr.appendChild(tdMethod);
          tr.appendChild(tdPath);
          tr.appendChild(tdDesc);
          tr.appendChild(tdExample);

          tbody.appendChild(tr);
        });
      } catch (err) {
        console.error(err);
        document.getElementById('routes-body').innerHTML = '<tr><td colspan="4" style="padding:20px;color:#f88">Failed to load routes.json</td></tr>';
      }
    }
    load();
  </script>
</body>
</html>
